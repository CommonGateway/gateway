App\Entity\Application:
    application:
        domains:
            - zaaksysteem-demo-api.commonground.nu
        name: main application
        organization: https://taalhuizen-bisc.commonground.nu/api/v1/cc/organizations/a0dc8cdc-c637-46b9-be8d-9103edc1e951

App\Entity\Gateway:
    zaaksysteem:
        name: zaaksysteem
        auth: apikey
        apikey: Ge9J&TYLB5*C2xGf^jObf$
        location: https://demo.pre.zaaksysteem.app/api/v1
        authorizationHeader: API-Key
        headers:
            Api-Interface-Id: 676

App\Entity\Endpoint:
    notificationEndpoint:
        name: Notification endpoint
        description: Endpoint for notifications
        path: notifications
    
    caseEndpoint:
        name: Case endpoint
        description: endpoint for cases
        path: cases
        
    caseTypeEndpoint:
        name: Case Type endpoint
        description: endpoint for case types
        path: casetypes

App\Entity\Subscriber:
    notificationToCase:
        name: notificationToCase
        description: A subscriber on a notifications that converts a exxellence case to a gateway case object.
        method: POST # default is post this can be removed
        type: internGateway
        entityOut: '@case'
        asynchronous: false
        entity: '@notification'
        mappingIn:
            externalUri: instance.case_url
            externalId: instance.case.reference
#        mappingOut:
#            instance.case_url: externalUri
#            instance.case.reference: externalId

App\Entity\Entity:
    # Notification Object
    notification:
        name: notifications
        route: "/api/notification"
        description: Holds information about a case
        endpoint: "notifications"

    # Case Object
    case:
        route: '/api/cases'
        name: cases
        description: Every action related to creating and maintaining cases.
        gateway: '@zaaksysteem'
        endpoint: 'case'
        #TODO: move collectionConfig to endpoint object later
        collectionConfig:
            results: 'result.instance.rows'
            envelope: 'instance'
            id: 'instance.id'
            paginationNext: 'result.instance.pager.next'
        #TODO: move itemConfig to endpoint object later
        itemConfig:
            envelope: 'result.instance'
        #TODO: move translationConfig to endpoint object later
        translationConfig:
            PUT:
                method: 'POST'
                endpoint: 'case/{id}/update'
            POST:
                endpoint: 'case/create'

    # Casetype Object
    caseType:
        route: '/api/casetypes'
        name: casetypes
        description: Every action related to listing and retrieving casetypes.
        gateway: '@zaaksysteem'
        endpoint: 'casetype'
        #TODO: move collectionConfig to endpoint object later
        collectionConfig:
            results: 'result.instance.rows'
            envelope: 'instance'
            id: 'instance.id'
            paginationNext: 'result.instance.pager.next'
        #TODO: move itemConfig to endpoint object later
        itemConfig:
            envelope: 'result.instance'

App\Entity\Attribute:

    # Notification attributes
    notification_caseUrl:
        name: caseUrl
        description: Url of this case.
        type: string
        required: true
        entity: "@notification"

    notification_caseReference:
        name: caseReference
        description: Reference of this case.
        type: string
        required: true
        entity: "@notification"

    notification_caseInstance:
        name: caseInstance
        description: Instance of this case.
        type: string
        entity: "@notification"

    notification_caseType:
        name: caseType
        description: Type of this case.
        type: string
        required: true
        entity: "@notification"

    notification_instanceType:
        name: instanceType
        description: Type of this instance.
        type: string
        required: true
        entity: "@notification"

    notification_text:
        name: text
        description: Message from this notification.
        type: string
        required: true
        entity: "@notification"

    notification_reference:
        name: reference
        description: Reference from this notification.
        type: string
        entity: "@notification"

    notification_type:
        name: type
        description: Type from this notification.
        type: string
        required: true
        entity: "@notification"

    # Case attributes
    case_casetype:
        name: casetype
        description: The casetype of this case
        type: object
#        required: true
        persistToGateway: true
        entity: '@case'
        object: '@caseType'
        objectConfig:
            envelope: 'instance'
            id: 'reference'
#    case_open:
#        name: open
#        description: The open of this case
#        type: string
#        persistToGateway: true
#        entity: '@case'
#        # Is probs. an enum?
#    case_confidentiality:
#        name: confidentiality
#        description: The confidentiality of this case
#        type: string
#        persistToGateway: true
#        entity: '@case'
#    case_source: # channel_of_contact but for input body only
#        name: source
#        description: The source of this case
#        type: string
#        required: true
#        persistToGateway: true
#        entity: '@case'
    case_channel_of_contact: # source but for response body only
        name: channel_of_contact
        description: The channel_of_contact of this case
        type: string
        persistToGateway: true
        entity: '@case'
    case_subject:
        name: subject
        description: The subject of this case
        type: string
        persistToGateway: true
        entity: '@case'
    case_subject_external:
        name: subject_external
        description: The subject_external of this case
        type: string
        persistToGateway: true
        entity: '@case'
    case_status:
        name: status
        description: The status of this case
        type: string
        enum: ['new', 'open', 'resolved', 'stalled']
        persistToGateway: true
        entity: '@case'
    case_number_master:
        name: number_master
        description: The number_master of this case
        type: integer
        persistToGateway: true
        entity: '@case'
    case_number:
        name: number
        description: The number of this case
        type: integer
        persistToGateway: true
        entity: '@case'
    case_date_of_registration:
        name: date_of_registration
        description: The date_of_registration of this case
        type: datetime
        persistToGateway: true
        entity: '@case'
    case_date_target:
        name: date_target
        description: The date_target of this case
        type: datetime
        persistToGateway: true
        entity: '@case'
    case_stalled_until:
        name: stalled_until
        description: The stalled_until of this case
        type: datetime
        persistToGateway: true
        entity: '@case'

    # Casetype attributes
    caseType_name: # = casetype_title
        name: name
        description: The name of this casetype.
        type: string
        maxLength: 255
        entity: '@caseType'
        persistToGateway: true
    caseType_title: # = casetype_name
        name: title
        description: The title of this casetype.
        type: string
        maxLength: 255
        entity: '@caseType'
        persistToGateway: true

App\Entity\Handler:
    notificationHandler:
        name: Notification handler
        sequence: 0
        conditions: "{}"
        mappingIn:
            caseUrl: instance.case_url
            caseReference: instance.case.reference
            caseInstance: instance.case.instance
            caseType: instance.case.type
            instanceType: instance.type
        mappingOut:
            instance.case_url: caseUrl
            instance.case.reference: caseReference
            instance.case.instance: caseInstance
            instance.case.type: caseType
            instance.type: instanceType
        endpoint: "@notificationEndpoint"
        entity: "@notification"
    
    caseHandler:
        name: Case handler
        sequence: 0
        conditions: "{}"
        endpoint: "@caseEndpoint"
        entity: "@case"

    caseTypeHandler:
        name: Case Type handler
        sequence: 0
        conditions: "{}"
        endpoint: "@caseTypeEndpoint"
        entity: "@caseType"
